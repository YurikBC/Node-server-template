!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t){e.exports='<div>\n    <h3>Page 3</h3>\n    <div data-item="button">new button</div>\n</div>'},function(e,t){e.exports='<div class="main">\n    <div class="cont" data-item="container">\n        <div data-item="cont-text"></div>\n    </div>\n</div>'},function(e,t){e.exports='<div class="row justify-content-center">\n    <div class="col-md-4 block__registration">\n        <div class="row justify-content-center">\n            <h2>Registration</h2>\n        </div>\n        <div class="row justify-content-center">\n            <div class="col-md-6">\n                <div class="form-group">\n                    <label for="firstName">First Name</label>\n                    <input\n                            data-item="form__firstName"\n                            id="firstName"\n                            type="text"\n                            class="form-control"\n                            required\n                            placeholder="Enter first name">\n                    <div class="invalid-feedback">\n                        Please provide a valid name.\n                    </div>\n                </div>\n            </div>\n            <div class="col-md-6">\n                <div class="form-group">\n                    <label for="secondName">Second Name</label>\n                    <input id="secondName"\n                           data-item="form__secondName"\n                           type="text"\n                           class="form-control"\n                           required\n                           placeholder="Enter second name">\n                    <div class="invalid-feedback">\n                        Please provide a valid name.\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="row justify-content-center">\n            <div class=" form-group col-md-12">\n                <label for="exampleInputEmail1">Email address</label>\n                <input data-item="form__email"\n                       type="email"\n                       class="form-control"\n                       id="exampleInputEmail1"\n                       aria-describedby="emailHelp"\n                       required\n                       placeholder="Enter email">\n                <small id="emailHelp" class="form-text text-muted">We\'ll never share your email with anyone else.</small>\n            </div>\n        </div>\n        <div class="row justify-content-center">\n            <div class="col-md-6">\n                <div class="form-group">\n                    <label for="password">Password</label>\n                    <input data-item="form__password"\n                           type="password"\n                           class="form-control"\n                           id="password"\n                           required\n                           placeholder="Enter password">\n                </div>\n            </div>\n            <div class="col-md-6">\n                <div class="form-group">\n                    <label for="repeatPassword">Repeat password</label>\n                    <input data-item="form__repeat-password"\n                           type="password"\n                           class="form-control"\n                           id="repeatPassword"\n                           required\n                           placeholder="Repeat password">\n                </div>\n            </div>\n        </div>\n        <div class="col-md-12">\n            <button data-item="button__submit"\n                    type="submit"\n                    class="btn btn-primary">Submit\n            </button>\n        </div>\n    </div>\n</div>\n<div class="row col-md-12 justify-content-center">\n    <div class="alert"\n         data-item="message-alert"\n         role="alert"\n         style="margin-top: 20px; display: none;">\n        You have been registred!\n    </div>\n</div>'},function(e,t){e.exports='<div class="row justify-content-center col-md-12">\n    <div class="col-md-4 block__login">\n        <div class="row col-md-12 justify-content-center">\n            <h1>Login</h1>\n        </div>\n        <form class="">\n            <div class="form-group">\n                <label for="exampleInputEmail1">Email address</label>\n                <input data-item="form__email"\n                       type="email"\n                       required\n                       class="form-control"\n                       id="exampleInputEmail1"\n                       aria-describedby="emailHelp"\n                       placeholder="Enter email">\n                <small id="emailHelp"\n                       class="form-text text-muted">We\'ll never share your email with anyone else.</small>\n                <div class="invalid-feedback">\n                    Please enter the correct email address\n                </div>\n            </div>\n            <div class="form-group">\n                <label for="exampleInputPassword1">Password</label>\n                <input data-item="form__password"\n                       required\n                       type="password"\n                       class="form-control"\n                       id="exampleInputPassword1"\n                       placeholder="Password">\n                <div class="invalid-feedback">\n                    Please enter your password\n                </div>\n            </div>\n        </form>\n        <div class="row justify-content-end">\n            <button data-item="button" type="submit" class="btn btn-primary" style="margin-right: 15px;">Submit</button>\n        </div>\n    </div>\n</div>\n<div class="row col-md-12 justify-content-center">\n    <div class="alert"\n         data-item="message-alert"\n         role="alert"\n         style="margin-top: 20px; display: none;">\n        You have been logged!\n    </div>\n</div>'},function(e,t,n){"use strict";n.r(t);let r={};const s=new class{emit(e,t){let n;return(r[e]||[]).forEach(e=>{n=e(t)}),n}on(e,t){r[e]||(r[e]=[]),r[e].push(t)}off(e){delete r[e]}};let a={};function o(e){let t=e;return"string"==typeof e&&(t=a[e]),t}var i={start(e){const t=Symbol();let n="function"==typeof e.init?e.init():{};return s.on(t,function([t,r]){return n=e[t](n,r)||n}),a[e.name]=t,t},send:(e,t)=>s.emit(o(e),t),end(e){s.off(o(e))}},l=n(3),d=n.n(l),c=n(2),m=n.n(c),u=n(1),_=n.n(u),R=n(0),v=n.n(R);var p={ROUTER_ACTOR:"routerActor",RENDER_ACTOR:"renderActor",USER_ACTOR:"userActor",SERVER_ACTOR:"serverActor",FIRST_PAGE_ACTOR:"firstPageActor",SECOND_PAGE_ACTOR:"mainPageActor",THIRD_PAGE_ACTOR:"thirdPageActor",REGISTRATION_ACTOR:"regPageActor",LOGIN_ACTOR:"loginPageActor",LOGIN:"Login",REGISTRATION:"Registration",SECOND_PAGE:"SecondPage",THIRD_PAGE:"thirdPage",MAIN_PAGE:"main",LOGIN_URL:"login",REGISTRATION_URL:"registration",SECOND_PAGE_URL:2,THIRD_PAGE_URL:3,MAIN_PAGE_URL:"/",TOKEN_NAME_IN_STORAGE:"token",USER_INFO_IN_STORAGE:"userInfo",LOGIN_API:"/api/user",REGISTRATION_API:"/api/auth",PAGE_DELAY_TIME:700};var E={attempt:(e,...t)=>{try{return e(t)}catch(e){return e instanceof Error?e:new Error(e)}},getElementByItem:e=>document.querySelector(`[data-item=${e}]`)};const{getElementByItem:f}=E,{LOGIN_ACTOR:A,SERVER_ACTOR:O,ROUTER_ACTOR:T,USER_ACTOR:g,MAIN_PAGE_URL:I,TOKEN_NAME_IN_STORAGE:w,USER_INFO_IN_STORAGE:N,LOGIN_API:h,PAGE_DELAY_TIME:b}=p,y={};let S={name:A,init(){return y.button=f("button"),y.emailForm=f("form__email"),y.passwordForm=f("form__password"),y.alertEl=f("message-alert"),y.button.addEventListener("click",()=>{this.controller.submitAction(y)}),y},controller:{submitAction(e){let t=P(e),n=L(e);n&&t&&i.send(O,["post",[h,n]]).then(t=>{let n=JSON.parse(t);G("success",e),i.send(g,["set",[w,n.token]]),i.send(g,["set",[N,n]]),setTimeout(()=>{i.send(T,["go",{address:I}])},b)}).catch(t=>{G("error",e,t)})}}};const P=e=>{return[e.emailForm,e.passwordForm].every(e=>{e.classList.remove("is-invalid"),e.classList.remove("is-valid");let t=e.checkValidity();return t?e.classList.add("is-valid"):e.classList.add("is-invalid"),t})},L=e=>{let t=e.emailForm.value,n=e.passwordForm.value;return t&&n?`email=${t}&password=${n}`:null},G=(e,t,n)=>{let r=t.alertEl;switch(e){case"success":r.classList.add("alert-success"),r.style.display="block";break;case"error":r.classList.add("alert-danger"),r.innerText=n,r.style.display="block"}};var C=S;const{getElementByItem:k}=E,{REGISTRATION_ACTOR:U,SERVER_ACTOR:x,ROUTER_ACTOR:D,USER_ACTOR:M,REGISTRATION_API:q,PAGE_DELAY_TIME:j}=p,F={},H={name:U,init(){const e=k("button__submit");return F.formFirstName=k("form__firstName"),F.formSecondName=k("form__secondName"),F.formEmail=k("form__email"),F.formPassword=k("form__password"),F.formRepeatPassword=k("form__repeat-password"),Object.keys(F).filter(e=>{F[e].addEventListener("input",$)}),e.addEventListener("click",()=>{this.controller.submit(F)}),F},controller:{submit(e){let t=B(e);if(H.view.clearAlertMessage(),t){let t=V(e);i.send(x,["post",[q,t]]).then(e=>{let t=JSON.parse(e);i.send(M,["setUser",t.token]),setTimeout(()=>{i.send(D,["go",{address:"/"}])},j)}).catch(e=>{H.view.showError(e)})}}},view:{messageEl:()=>k("message-alert"),clearAlertMessage(){this.messageEl().classList.remove("alert-danger")},showSuccess(){this.messageEl().classList.add("alert-success"),this.messageEl().style.display="block"},showError(e){this.messageEl().classList.add("alert-danger"),this.messageEl().innerText=e,this.messageEl().style.display="block"}}},V=e=>{return`firstName=${e.formFirstName.value}`+`&secondName=${e.formSecondName.value}`+`&email=${e.formEmail.value}`+`&password=${e.formPassword.value}`},$=e=>{let t=e.target?e.target:e;t.classList.remove("is-invalid"),t.classList.remove("is-valid");let n=t.checkValidity();return"form__repeat-password"===t.dataset.item&&k("form__password").value!==t.value&&(n=!1),n?t.classList.add("is-valid"):t.classList.add("is-invalid"),!n},B=e=>{return 0===Object.keys(e).filter(t=>$(e[t])).length};var Y=H;const{SECOND_PAGE_ACTOR:J,USER_INFO_IN_STORAGE:K,USER_ACTOR:W}=p,{getElementByItem:X}=E;let z={};var Q={name:J,init(){let e=X("cont-text"),t=i.send(W,["get",K]);e.innerText=`Hello, ${t.firstname} ${t.secondname}`},validateForm(){z.formValue.innerText=z.form.value}};var Z={name:"thirdPageActor",init(){let e=document.querySelector('[data-item="button"]');return e.addEventListener("click",()=>{i.send("thirdPageActor",["triggerAlert",event])}),{button:e}},triggerAlert(e,t){console.log(e,t)}};const{LOGIN:ee,REGISTRATION:te,SECOND_PAGE:ne,THIRD_PAGE:re,MAIN_PAGE:se,LOGIN_URL:ae,REGISTRATION_URL:oe,SECOND_PAGE_URL:ie,THIRD_PAGE_URL:le,MAIN_PAGE_URL:de}=p;var ce=[{name:ee,address:ae,template:d.a,controller:C,tokenRequired:!1},{name:te,address:oe,template:m.a,controller:Y,tokenRequired:!1},{name:se,address:de,template:_.a,controller:Q,tokenRequired:!0},{name:ne,address:ie,template:v.a,controller:Q,tokenRequired:!0},{name:re,address:le,template:v.a,controller:Z,tokenRequired:!1}];const{USER_ACTOR:me,ROUTER_ACTOR:ue}=p,_e=Symbol("onHashChange");var Re={name:ue,init(){return window.addEventListener("hashchange",this[_e]),this[_e](),{}},go(e,t){window.location.hash=t.address},[_e](){let e=(e=>e.filter(e=>window.location.hash?window.location.hash.replace("#","")==e.address:"/"===e.address))(ce),t=e.length?e[0]:ce[0];if((e=>{let t=i.send(me,["get","token"]).token;return!e.tokenRequired||!(!e.tokenRequired||!t)})(t)){i.send("renderActor",["paint",t]),(new Ue).create(t.controller.name)}else window.location.hash=ce[0].address}};const{RENDER_ACTOR:ve}=p;var pe={name:ve,init:()=>({mainEl:document.getElementById("a-app")}),paint(e,t){e.mainEl&&(e.mainEl.innerHTML=t.template)},getState:e=>e};const{USER_ACTOR:Ee,TOKEN_NAME_IN_STORAGE:fe,USER_INFO_IN_STORAGE:Ae}=p,Oe={token:e=>(e.token=window.sessionStorage.getItem(fe),e),userInfo(){let e=sessionStorage.getItem(Ae);return JSON.parse(e)}},Te={token(e,t){sessionStorage.setItem(fe,t)},userInfo(e,t){let n={...e,...t};delete n.password,delete n.token,sessionStorage.setItem(Ae,JSON.stringify(n))}};var ge={name:Ee,init:()=>({token:null}),get(e,t){switch(t){case fe:return Oe.token(e);case Ae:return Oe.userInfo()}},set(e,[t,n]){switch(t){case fe:return Te.token(n);case Ae:return Te.userInfo(e,n)}}};const{SERVER_ACTOR:Ie}=p;var we={name:Ie,init:()=>({}),post(e,[t,n]){let r=new XMLHttpRequest;return r.open("POST",t,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(n),new Promise((e,t)=>{r.onload=(()=>{200===r.status?e(r.response):t(r.response)})})}};const{ROUTER_ACTOR:Ne,RENDER_ACTOR:he,USER_ACTOR:be,SERVER_ACTOR:ye,SECOND_PAGE_ACTOR:Se,THIRD_PAGE_ACTOR:Pe,REGISTRATION_ACTOR:Le,LOGIN_ACTOR:Ge}=p;var Ce={[Ne]:Re,[he]:pe,[be]:ge,[ye]:we,[Ge]:C,[Se]:Q,[Pe]:Z,[Le]:Y,[Le]:Y};function ke(){}ke.prototype={constructor:ke,create(e){if(Ce[e]){let t=Ce[e];return i.start(t)}},remove(e){let t=Ce[e].name;return i.end(t)}};var Ue=ke;n(10);const{getElementByItem:xe}=E,{USER_ACTOR:De,SERVER_ACTOR:Me,RENDER_ACTOR:qe,ROUTER_ACTOR:je,MAIN_PAGE_URL:Fe,LOGIN_URL:He,REGISTRATION_URL:Ve}=p;let $e;document.addEventListener("DOMContentLoaded",()=>{($e=new Ue).create(Me),$e.create(De),$e.create(qe),$e.create(je),xe("home-link").href="#"+Fe,xe("logo-link").href="#"+Fe,xe("login-link").href="#"+He,xe("reg-link").href="#"+Ve}),window.addEventListener("onclose",()=>{$e.remove(Me),$e.remove(De),$e.remove(qe),$e.remove(je)})},,,,,,function(e,t){}]);