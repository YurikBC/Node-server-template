!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t){e.exports='<div>\n    <h3>Page 2</h3>\n    <input data-item="form" type="text">\n    <div data-item="formValue" ></div>\n</div>'},function(e,t){e.exports='<div>\n    <h3>Page 3</h3>\n    <div data-item="button">new button</div>\n</div>'},function(e,t){e.exports='<div class="row justify-content-center">\n    <div class="col-md-4 registration-block">\n        <div class="row justify-content-center">\n            <h2>Registration</h2>\n        </div>\n        <div class="row justify-content-center">\n            <div class="col-md-6">\n                <div class="form-group">\n                    <label for="firstName">First Name</label>\n                    <input\n                            data-item="form__firstName"\n                            id="firstName"\n                            type="text"\n                            class="form-control"\n                            required\n                            placeholder="Enter first name">\n                    <div class="invalid-feedback">\n                        Please provide a valid name.\n                    </div>\n                </div>\n            </div>\n            <div class="col-md-6">\n                <div class="form-group">\n                    <label for="secondName">Second Name</label>\n                    <input id="secondName"\n                           data-item="form__secondName"\n                           type="text"\n                           class="form-control"\n                           required\n                           placeholder="Enter second name">\n                    <div class="invalid-feedback">\n                        Please provide a valid name.\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="row justify-content-center">\n            <div class=" form-group col-md-12">\n                <label for="exampleInputEmail1">Email address</label>\n                <input data-item="form__email"\n                       type="email"\n                       class="form-control"\n                       id="exampleInputEmail1"\n                       aria-describedby="emailHelp"\n                       required\n                       placeholder="Enter email">\n                <small id="emailHelp" class="form-text text-muted">We\'ll never share your email with anyone else.</small>\n            </div>\n        </div>\n        <div class="row justify-content-center">\n            <div class="col-md-6">\n                <div class="form-group">\n                    <label for="password">Password</label>\n                    <input data-item="form__password"\n                           type="password"\n                           class="form-control"\n                           id="password"\n                           required\n                           placeholder="Enter password">\n                </div>\n            </div>\n            <div class="col-md-6">\n                <div class="form-group">\n                    <label for="repeatPassword">Repeat password</label>\n                    <input data-item="form__repeat-password"\n                           type="password"\n                           class="form-control"\n                           id="repeatPassword"\n                           required\n                           placeholder="Repeat password">\n                </div>\n            </div>\n        </div>\n        <div class="col-md-12">\n            <button data-item="button__submit"\n                    type="submit"\n                    class="btn btn-primary">Submit\n            </button>\n        </div>\n    </div>\n</div>\n<div class="row col-md-12 justify-content-center">\n    <div class="alert"\n         data-item="message-alert"\n         role="alert"\n         style="margin-top: 20px; display: none;">\n        You have been registred!\n    </div>\n</div>'},function(e,t){e.exports='<div class="container-fluid">\n        <div class="row justify-content-center">\n            <h1>Login</h1>\n        </div>\n        <div class="row col-md-12 justify-content-center">\n            <form class="col-md-3">\n                <div class="form-group">\n                    <label for="exampleInputEmail1">Email address</label>\n                    <input data-item="form__email" type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">\n                    <small id="emailHelp" class="form-text text-muted">We\'ll never share your email with anyone else.</small>\n                </div>\n                <div class="form-group">\n                    <label for="exampleInputPassword1">Password</label>\n                    <input data-item="form__password" type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">\n                </div>\n                <button data-item="button" type="submit" class="btn btn-primary">Submit</button>\n            </form>\n        </div>\n</div>'},function(e,t,n){"use strict";n.r(t);let r={};const a=new class{emit(e,t){let n;return(r[e]||[]).forEach(e=>{n=e(t)}),n}on(e,t){r[e]||(r[e]=[]),r[e].push(t)}off(e){delete r[e]}};let o={};function s(e){let t=e;return"string"==typeof e&&(t=o[e]),t}var i={start(e){const t=Symbol();let n="function"==typeof e.init?e.init():{};return a.on(t,function([t,r]){return n=e[t](n,r)||n}),o[e.name]=t,t},send:(e,t)=>a.emit(s(e),t),end(e){a.off(s(e))}},l=n(3),d=n.n(l),c=n(2),m=n.n(c),u=n(0),p=n.n(u),f=n(1),v=n.n(f);const R={};var _={name:"loginPageActor",init(){return R.button=document.querySelector('[data-item="button"]'),R.emailForm=document.querySelector('[data-item="form__email"]'),R.passwordForm=document.querySelector('[data-item="form__password"]'),R.button.addEventListener("click",()=>{this.post(R)}),R},count(e){let t=new XMLHttpRequest;t.open("GET","/api/user",!1),t.onreadystatechange=function(){console.log(t.response),console.log("dfvdfv")},t.send()},post(e){let t=e.emailForm.value,n=e.passwordForm.value,r=new XMLHttpRequest,a=`email=${t}&password=${n}`;r.open("POST","/api/user",!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(a),r.onload=(()=>{let e=JSON.parse(r.response);sessionStorage.setItem("token",e.token)})}};var E={ROUTER_ACTOR:"routerActor",RENDER_ACTOR:"renderActor",USER_ACTOR:"userActor",SERVER_ACTOR:"serverActor",FIRST_PAGE_ACTOR:"firstPageActor",SECOND_PAGE_ACTOR:"secondPageActor",THIRD_PAGE_ACTOR:"thirdPageActor",REGISTRATION_ACTOR:"regPageActor",LOGIN:"Login",REGISTRATION:"Registration",SECOND_PAGE:"SecondPage",THIRD_PAGE:"thirdPage",MAIN_PAGE:"main",LOGIN_URL:"login",REGISTRATION_URL:"registration",SECOND_PAGE_URL:2,THIRD_PAGE_URL:3,MAIN_PAGE_URL:"/",TOKEN_NAME_IN_STORAGE:"token"};var A={attempt:(e,...t)=>{try{return e(t)}catch(e){return e instanceof Error?e:new Error(e)}},getElementByItem:e=>document.querySelector(`[data-item=${e}]`)};const w={},{getElementByItem:T}=A,{REGISTRATION_ACTOR:g,SERVER_ACTOR:O,ROUTER_ACTOR:b,USER_ACTOR:y}=E;function h(e){let t=e.target?e.target:e;t.classList.remove("is-invalid"),t.classList.remove("is-valid");let n=t.checkValidity();return"form__repeat-password"===t.dataset.item&&T("form__password").value!==t.value&&(n=!1),n?t.classList.add("is-valid"):t.classList.add("is-invalid"),!n}var S={name:g,init(){let e=T("button__submit");return w.formFirstName=T("form__firstName"),w.formSecondName=T("form__secondName"),w.formEmail=T("form__email"),w.formPassword=T("form__password"),w.formRepeatPassword=T("form__repeat-password"),Object.keys(w).filter(e=>{w[e].addEventListener("input",h)}),e.addEventListener("click",()=>{this.submit(w)}),w},submit(e){(e=>{Object.keys(e).filter(t=>h(e[t])).length})(e);let t=T("message-alert");t.classList.remove("alert-danger");let n=(e=>{return`firstName=${e.formFirstName.value}`+`&secondName=${e.formSecondName.value}`+`&email=${e.formEmail.value}`+`&password=${e.formPassword.value}`})(e);i.send(O,["post",n]).then(e=>{let n=JSON.parse(e);i.send(y,["setToken",n.token]),t.classList.add("alert-success"),t.style.display="block",setTimeout(()=>{i.send(b,["go",{address:"/"}])},850)}).catch(e=>{t.classList.add("alert-danger"),t.innerText=e,t.style.display="block"})}};let N={};var P={name:"secondPageActor",init(){N.form=document.querySelector('[data-item="form"]'),N.formValue=document.querySelector('[data-item="formValue"]'),N.form.addEventListener("input",()=>{i.send(this.name,["validateForm"])})},validateForm(){N.formValue.innerText=N.form.value}};var I={name:"thirdPageActor",init(){let e=document.querySelector('[data-item="button"]');return e.addEventListener("click",()=>{i.send("thirdPageActor",["triggerAlert",event])}),{button:e}},triggerAlert(e,t){console.log(e,t)}};const{LOGIN:C,REGISTRATION:L,SECOND_PAGE:k,THIRD_PAGE:G,MAIN_PAGE:x,LOGIN_URL:q,REGISTRATION_URL:U,SECOND_PAGE_URL:H,THIRD_PAGE_URL:D,MAIN_PAGE_URL:j}=E;var M=[{name:C,address:q,template:d.a,controller:_,tokenRequired:!1},{name:L,address:U,template:m.a,controller:S,tokenRequired:!1},{name:x,address:j,template:p.a,controller:P,tokenRequired:!0},{name:k,address:H,template:p.a,controller:P,tokenRequired:!0},{name:G,address:D,template:v.a,controller:I,tokenRequired:!1}];const{USER_ACTOR:F,ROUTER_ACTOR:V}=E,$=Symbol("onHashChange");var B={name:V,init(){return window.addEventListener("hashchange",this[$]),this[$](),{}},go(e,t){window.location.hash=t.address},[$](){let e=(e=>e.filter(e=>window.location.hash.replace("#","")==e.address))(M),t=e.length?e[0]:M[0];if((e=>{let t=i.send(F,["checkToken"]).token;return!e.tokenRequired||!(!e.tokenRequired||!t)})(t)){i.send("renderActor",["paint",t]),(new de).create(t.controller.name)}else window.location.hash=M[0].address}};const{RENDER_ACTOR:X}=E;var J={name:X,init:()=>({mainEl:document.getElementById("a-app")}),paint(e,t){e.mainEl&&(e.mainEl.innerHTML=t.template)},getState:e=>e};const{USER_ACTOR:K,TOKEN_NAME_IN_STORAGE:W}=E;var Y={name:K,init:()=>({token:null}),checkToken:e=>(e.token=window.sessionStorage.getItem(W),e),setToken(e,t){sessionStorage.setItem("token",t)}};const{SERVER_ACTOR:z}=E;var Q={name:z,init:()=>({}),post(e,t){let n=new XMLHttpRequest,r=t;return n.open("POST","/api/auth",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(r),new Promise((e,t)=>{n.onload=(()=>{200===n.status?e(n.response):t(n.response)})})}};const{ROUTER_ACTOR:Z,RENDER_ACTOR:ee,USER_ACTOR:te,SERVER_ACTOR:ne,FIRST_PAGE_ACTOR:re,SECOND_PAGE_ACTOR:ae,THIRD_PAGE_ACTOR:oe,REGISTRATION_ACTOR:se}=E;var ie={[Z]:B,[ee]:J,[te]:Y,[ne]:Q,[re]:_,[ae]:P,[oe]:I,[se]:S};function le(){}le.prototype={constructor:le,create(e){if(ie[e]){let t=ie[e];return i.start(t)}},remove(e){let t=ie[e].name;return i.end(t)}};var de=le;const{USER_ACTOR:ce}=E;let me;document.addEventListener("DOMContentLoaded",()=>{(me=new de).create("serverActor"),me.create([ce]),me.create("renderActor"),me.create("routerActor"),function(){let e=[...document.getElementById("nav").children];for(let t in e)e[t].addEventListener("click",e=>{i.send("routerActor",["go",M[+e.target.innerText-1]])})}()}),window.onbeforeunload=(()=>{me.remove("renderActor"),me.remove("routerActor")})}]);